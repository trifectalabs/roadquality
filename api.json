{
  "name": "road_quality",
  "description": "Crowd-sourced road quality data",
  "apidoc": { "version": "0.9.11" },
  "enums": {
    "path_type": {
      "description": "The level of dedication of the segment to cycling",
      "values": [
        {
          "name": "shared",
          "description": "A shared road for cars and bikes (road shoulder)"
        },
        {
          "name": "dedicated_lane",
          "description": "A dedicated bike lane on the road"
        },
        {
          "name": "bike_path",
          "description": "A completely isolated bike lane (a natural barrier from road traffic)"
        }
      ]
    },
    "surface": {
      "description": "The surface type of a segment (road type)",
      "values": [
        {
          "name": "gravel",
          "description": "Road consisting of small rocks"
        },
        {
          "name": "asphalt",
          "description": "Road consisting of paved asphalt"
        },
        {
          "name": "dirt",
          "description": "Road consisting of cleared dirt"
        }
      ]
    },
    "user_role": {
      "description": "The type of user (user or admin)",
      "values": [
        {
          "name": "user",
          "description": "A standard consumer of the service"
        },
        {
          "name": "admin",
          "description": "An administrator of the application"
        }
      ]
    }
  },
  "models": {
    "point": {
      "description": "A longitudinal or latitudinal coordatine",
      "fields": [
        { "name": "lat",
          "type" : "double"
        },
        { "name": "lng",
          "type" : "double"
        }
      ]
    },
    "map_route": {
      "description": "A routable path on a map - not necessarily a segment",
      "fields": [
        { "name": "polyline",
          "type" : "string"
        },
        { "name": "distance",
          "type" : "double"
        }
      ]
    },
    "segment": {
      "description": "A segment of road which will be rated and tagged",
      "fields": [
        { "name": "id",
          "type" : "uuid"
        },
        { "name": "name",
          "type" : "string",
          "required": false
        },
        { "name": "description",
          "type" : "string",
          "required": false
        },
        { "name": "start",
          "type" : "point"
        },
        { "name": "end",
          "type" : "point"
        },
        { "name": "polyline",
          "type" : "string"
        },
        { "name": "overall_rating",
          "type" : "double",
          "description": "The average of all ratings for this segment"
        },
        { "name": "surface_rating",
          "type" : "double"
        },
        { "name": "traffic_rating",
          "type" : "double"
        },
        { "name": "surface",
          "type" : "surface"
        },
        { "name": "path_type",
          "type" : "path_type"
        }
      ]
    },
    "segment_form": {
      "description": "Form the client uses to create a segment",
      "fields": [
        { "name": "name",
          "type" : "string",
          "required": false
        },
        { "name": "description",
          "type" : "string",
          "required": false
        },
        { "name": "points",
          "type" : "[point]"
        },
        { "name": "surface_rating",
          "type" : "double"
        },
        { "name": "traffic_rating",
          "type" : "double"
        },
        { "name": "surface",
          "type" : "surface",
          "default": "asphalt"
        },
        { "name": "path_type",
          "type" : "path_type",
          "default": "shared"
        }
      ]
    },
    "version_info": {
      "plural": "info",
      "fields": [
        {
          "name": "name",
          "type": "string",
          "description": "Name of this service"
        },
        {
          "name": "version",
          "type": "string",
          "description": "Version of this service"
        },
        {
          "name": "scalaVersion",
          "type": "string",
          "description": "Version of Scala used to build this service"
        },
        {
          "name": "sbtVersion",
          "type": "string",
          "description": "Version of SBT used to build this service"
        }
      ]
    },
    "user": {
      "description": "A user of the service",
      "fields": [
        { "name": "id",
          "type" : "uuid"
        },
        { "name": "first_name",
          "type" : "string"
        },
        { "name": "last_name",
          "type" : "string"
        },
        { "name": "email",
          "type" : "string"
        },
        { "name": "created_at",
          "type" : "date-time-iso8601"
        },
        { "name": "role",
          "type" : "user_role",
          "default": "user"
        }
      ]
    },
    "user_form": {
      "description": "A form used to create a user",
      "fields": [
        { "name": "first_name",
          "type" : "string"
        },
        { "name": "last_name",
          "type" : "string"
        },
        { "name": "email",
          "type" : "string"
        }
      ]
    }
  },
  "resources" : {
    "map_route": {
      "operations": [
        { "method": "GET",
          "parameters": [
            { "name": "start_lat", "type": "double" },
            { "name": "start_lng", "type": "double" },
            { "name": "end_lat", "type": "double" },
            { "name": "end_lng", "type": "double" }
          ],
          "responses": {
            "200": { "type": "map_route" }
          }
        },
        { "method": "GET",
          "path": "/snap",
          "parameters": [
            { "name": "lat", "type": "double" },
            { "name": "lng", "type": "double" }
          ],
          "responses": {
            "200": { "type": "map_route" }
          }
        },
        { "method": "POST",
          "body": { "type": "[point]" },
          "responses": {
            "200": { "type": "map_route" }
          }
        }
      ]
    },
    "segment": {
      "operations": [
        { "method": "GET",
          "path": "/all",
          "responses": {
            "200": { "type": "[segment]" },
            "404": { "type": "string" }
          }
        },
        { "method": "GET",
          "path": "/:segment_id",
          "parameters": [
            { "name": "segment_id", "type": "uuid" }
          ],
          "responses": {
            "200": { "type": "segment" },
            "404": { "type": "string" }
          }
        },
        { "method": "POST",
          "body": { "type": "segment_form" },
          "responses": {
            "201": { "type": "segment" },
            "400": { "type": "string" }
          }
        },
        { "method": "PATCH",
          "path": "/:segment_id/rating/traffic/:rating",
          "parameters": [
            { "name": "segment_id", "type": "uuid" },
            { "name": "rating", "type": "double" }
          ],
          "responses": {
            "200": { "type": "segment" },
            "400": { "type": "string" },
            "404": { "type": "string" }
          }
        },
        { "method": "PATCH",
          "path": "/:segment_id/rating/surface/:rating",
          "parameters": [
            { "name": "segment_id", "type": "uuid" },
            { "name": "rating", "type": "double" }
          ],
          "responses": {
            "200": { "type": "segment" },
            "400": { "type": "string" },
            "404": { "type": "string" }
          }
        }
      ]
    },
    "version_info": {
      "operations": [
        { "method": "GET",
          "responses": {
            "200": { "type": "version_info" }
          }
        }
      ]
    }
  }
}
